\hypertarget{file_8h}{}\section{file.\+h File Reference}
\label{file_8h}\index{file.\+h@{file.\+h}}
{\ttfamily \#include \char`\"{}stdio.\+h\char`\"{}}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}data.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}estado.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}jogada.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{file_8h_a88be94d179abd5073870fc1d206b3770}{gr} (char $\ast$file\+\_\+name, \hyperlink{structESTADO}{E\+S\+T\+A\+DO} $\ast$estado)
\begin{DoxyCompactList}\small\item\em Esta função lê o Estado atual e grava o tabuleiro correspondente num ficheiro. \end{DoxyCompactList}\item 
void \hyperlink{file_8h_ae6bfa898954094e9a4f4540e72ac3c81}{ler} (char $\ast$file\+\_\+name, \hyperlink{structESTADO}{E\+S\+T\+A\+DO} $\ast$estado)
\begin{DoxyCompactList}\small\item\em Esta função lê um ficheiro e verifica o Estado do tabuleiro. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Definição do 

\subsection{Function Documentation}
\mbox{\Hypertarget{file_8h_a88be94d179abd5073870fc1d206b3770}\label{file_8h_a88be94d179abd5073870fc1d206b3770}} 
\index{file.\+h@{file.\+h}!gr@{gr}}
\index{gr@{gr}!file.\+h@{file.\+h}}
\subsubsection{\texorpdfstring{gr()}{gr()}}
{\footnotesize\ttfamily void gr (\begin{DoxyParamCaption}\item[{char $\ast$}]{file\+\_\+name,  }\item[{\hyperlink{structESTADO}{E\+S\+T\+A\+DO} $\ast$}]{estado }\end{DoxyParamCaption})}



Esta função lê o Estado atual e grava o tabuleiro correspondente num ficheiro. 


\begin{DoxyParams}{Parameters}
{\em file\+\_\+name} & O nome do ficheiro \\
\hline
{\em estado} & O estado atual \\
\hline
\end{DoxyParams}


Definition at line 3 of file file.\+c.


\begin{DoxyCode}
3                                         \{
4     FILE *file\_p;
5     file\_p = fopen(file\_name, \textcolor{stringliteral}{"w"});
6     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < 8; i++)\{
7         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j = 0; j < 8; j++)\{
8             \hyperlink{data_8h_aba91601f16d4c485b2d9b8c429f27039}{CASA} cs = estado->\hyperlink{structESTADO_ab56f0f1be16954d3768b4174d14c087d}{tab}[i][j];
9             \textcolor{keywordflow}{if}(cs == POS1) fprintf(file\_p, \textcolor{stringliteral}{"1"});
10             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(cs == POS2) fprintf(file\_p, \textcolor{stringliteral}{"2"});
11             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(cs == RASTRO) fprintf(file\_p, \textcolor{stringliteral}{"#"});
12             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(cs == PECA) fprintf(file\_p, \textcolor{stringliteral}{"*"});
13             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(cs == VAZIO) fprintf(file\_p, \textcolor{stringliteral}{"."});
14         \}
15         fprintf(file\_p, \textcolor{stringliteral}{"\(\backslash\)n"});
16     \}
17 
18     fprintf(file\_p, \textcolor{stringliteral}{"\(\backslash\)n"});
19 
20     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < (\hyperlink{estado_8h_a6cd0b387bdee9e18003c78852394aa63}{obter\_numero\_de\_jogadas}(estado) + 1); i++)\{
21         \hyperlink{structCOORDENADA}{COORDENADA} jogador1 = estado->\hyperlink{structESTADO_afae43b87a488fad0f2b56a18bad31d18}{jogadas}[i].jogador1;
22         \hyperlink{structCOORDENADA}{COORDENADA} jogador2 = estado->\hyperlink{structESTADO_afae43b87a488fad0f2b56a18bad31d18}{jogadas}[i].jogador2;
23 
24         \textcolor{keywordflow}{if}(jogador1.linha != -1)\{
25             \textcolor{keywordflow}{if}(i < 9)\{
26                 fprintf(file\_p, \textcolor{stringliteral}{"0%d: "}, i+1);
27             \}\textcolor{keywordflow}{else}\{
28                 fprintf(file\_p, \textcolor{stringliteral}{"%d: "}, i+1);
29             \}
30 
31             \textcolor{keywordtype}{char} coluna = \textcolor{charliteral}{'a'} + jogador1.coluna;
32             \textcolor{keywordtype}{int} linha = 8 - jogador1.linha;
33             fprintf(file\_p, \textcolor{stringliteral}{"%c%d "}, coluna, linha);
34         \}
35         \textcolor{keywordflow}{if}(jogador2.linha != -1)\{
36             \textcolor{keywordtype}{char} coluna = \textcolor{charliteral}{'a'} + jogador2.coluna;
37             \textcolor{keywordtype}{int} linha = 8 - jogador2.linha;
38             fprintf(file\_p, \textcolor{stringliteral}{"%c%d\(\backslash\)n"}, coluna, linha);
39         \}
40     \}
41 
42     fclose(file\_p);
43 \}
\end{DoxyCode}
\mbox{\Hypertarget{file_8h_ae6bfa898954094e9a4f4540e72ac3c81}\label{file_8h_ae6bfa898954094e9a4f4540e72ac3c81}} 
\index{file.\+h@{file.\+h}!ler@{ler}}
\index{ler@{ler}!file.\+h@{file.\+h}}
\subsubsection{\texorpdfstring{ler()}{ler()}}
{\footnotesize\ttfamily void ler (\begin{DoxyParamCaption}\item[{char $\ast$}]{file\+\_\+name,  }\item[{\hyperlink{structESTADO}{E\+S\+T\+A\+DO} $\ast$}]{estado }\end{DoxyParamCaption})}



Esta função lê um ficheiro e verifica o Estado do tabuleiro. 


\begin{DoxyParams}{Parameters}
{\em file\+\_\+name} & O nome do ficheiro \\
\hline
{\em estado} & O estado atual \\
\hline
\end{DoxyParams}


Definition at line 46 of file file.\+c.


\begin{DoxyCode}
46                                          \{
47 FILE *file\_p;
48     file\_p = fopen(file\_name, \textcolor{stringliteral}{"r"});
49     \textcolor{keywordtype}{char} line[150];
50     \hyperlink{data_8h_aba91601f16d4c485b2d9b8c429f27039}{CASA} tabuleiro[8][8];
51 
52     \textcolor{keywordflow}{if}(file\_p == NULL)\{
53         printf(\textcolor{stringliteral}{"Nome de ficheiro invalido\(\backslash\)n"});
54         \textcolor{keywordflow}{return};
55     \}
56 
57     \hyperlink{estado_8h_a8c15dc48cadd06ac3887d88e47fd5ed1}{resetJogadas}(estado);
58     estado->\hyperlink{structESTADO_a261495728744647e618b4e623f5a4b7a}{num\_jogadas} = 0;
59 
60     \textcolor{keywordtype}{int} linha = 0;
61     \textcolor{keywordflow}{while}(1)\{
62         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < 150; i++)\{
63             line[i] = \textcolor{charliteral}{'\(\backslash\)0'};
64         \}
65         \textcolor{comment}{//fgets(line, 150, file\_p);}
66 
67         \textcolor{keywordflow}{if}(fgets(line, 150, file\_p) != NULL)\{
68             \textcolor{keywordflow}{if}(linha < 8)\{
69                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < 8; i++)\{
70                     \textcolor{keywordflow}{if}(line[i] == \textcolor{charliteral}{'1'}) tabuleiro[linha][i] = POS1;
71                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(line[i] == \textcolor{charliteral}{'2'}) tabuleiro[linha][i] = POS2;
72                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(line[i] == \textcolor{charliteral}{'#'}) tabuleiro[linha][i] = RASTRO;
73                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(line[i] == \textcolor{charliteral}{'*'}) tabuleiro[linha][i] = PECA;
74                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(line[i] == \textcolor{charliteral}{'.'}) tabuleiro[linha][i] = VAZIO;
75                 \}
76             \}\textcolor{keywordflow}{else}\{
77                 \textcolor{keywordflow}{if}(strcmp(line, \textcolor{stringliteral}{"\(\backslash\)n"}) != 0)\{
78                     \hyperlink{structCOORDENADA}{COORDENADA} jog1\_coord;
79                     jog1\_coord.coluna = line[4] - \textcolor{charliteral}{'a'};
80                     jog1\_coord.linha = 7 - (line[5] - \textcolor{charliteral}{'1'});
81 
82                     \textcolor{comment}{//printf("1: %c %c\(\backslash\)n", line[4], line[5]);}
83                     \textcolor{comment}{//printf("1: %d %d\(\backslash\)n", jog1\_coord.coluna, jog1\_coord.linha);}
84 
85                     \hyperlink{structCOORDENADA}{COORDENADA} jog2\_coord;
86                     jog2\_coord.coluna = line[7] - \textcolor{charliteral}{'a'};
87                     jog2\_coord.linha = 7 - (line[8] - \textcolor{charliteral}{'1'});
88 
89                     \textcolor{comment}{//printf("2: %c %c\(\backslash\)n", line[7], line[8]);}
90                     \textcolor{comment}{//printf("2: %d %d\(\backslash\)n", jog2\_coord.coluna, jog2\_coord.linha);}
91 
92                     \textcolor{keywordflow}{if}(0 <= jog1\_coord.coluna && jog1\_coord.coluna <= 7)\{
93                         estado->\hyperlink{structESTADO_a5dd28e2e68b7aef2b6b7ea88e02eff58}{jogador\_atual} = 1;
94                         \hyperlink{jogada_8h_a4067bb2bd3a973474435b8bebcf51775}{adicionar\_jogada}(estado, jog1\_coord);
95                         estado->\hyperlink{structESTADO_a5dd28e2e68b7aef2b6b7ea88e02eff58}{jogador\_atual} = 2;
96                     \}
97 
98                     \textcolor{keywordflow}{if}(0 <= jog2\_coord.coluna && jog2\_coord.coluna <= 7)\{
99                         estado->\hyperlink{structESTADO_a5dd28e2e68b7aef2b6b7ea88e02eff58}{jogador\_atual} = 2;
100                         \hyperlink{jogada_8h_a4067bb2bd3a973474435b8bebcf51775}{adicionar\_jogada}(estado, jog2\_coord);
101                         estado->\hyperlink{structESTADO_a5dd28e2e68b7aef2b6b7ea88e02eff58}{jogador\_atual} = 1;
102                     \}
103                 \}
104             \}
105         \}
106 
107         \textcolor{keywordflow}{if}(feof(file\_p))\{
108             \textcolor{keywordflow}{break};
109         \}
110         linha++;
111     \}
112 
113     \hyperlink{estado_8h_ab3b8be2c1d31ca864df920d8f0df3a04}{setTabuleiro}(estado, tabuleiro);
114     estado->\hyperlink{structESTADO_a4896a5c5c1f40b43fb795623327e3f47}{ultima\_jogada} = \hyperlink{estado_8h_aa21af881dfebf0f0e822b806edf9a006}{obter\_coordenada\_peca}(tabuleiro);
115 
116     \textcolor{comment}{// FIX Bug de linha no ficheiro}
117     \textcolor{comment}{/*if(obter\_jogador\_atual(estado) == 1)\{}
118 \textcolor{comment}{        COORDENADA nula;}
119 \textcolor{comment}{        nula.linha = -1;}
120 \textcolor{comment}{        nula.coluna = -1;}
121 \textcolor{comment}{}
122 \textcolor{comment}{        estado->num\_jogadas = estado->num\_jogadas-1;}
123 \textcolor{comment}{}
124 \textcolor{comment}{        estado->jogadas[obter\_numero\_de\_jogadas(estado)].jogador1 = nula;}
125 \textcolor{comment}{        estado->jogadas[obter\_numero\_de\_jogadas(estado)].jogador2 = nula;}
126 \textcolor{comment}{    \}*/}
128 
129     \textcolor{comment}{/*if (obter\_jogador\_atual(estado) != 1) \{}
130 \textcolor{comment}{        estado->jogador\_atual = 1;}
131 \textcolor{comment}{    \} else \{}
132 \textcolor{comment}{        estado->jogador\_atual = 2;}
133 \textcolor{comment}{        estado->num\_jogadas = obter\_numero\_de\_jogadas(estado) - 1;}
134 \textcolor{comment}{    \}}
135 \textcolor{comment}{}
136 \textcolor{comment}{    COORDENADA nula;}
137 \textcolor{comment}{    nula.linha = -1;}
138 \textcolor{comment}{    nula.coluna = -1;}
139 \textcolor{comment}{}
140 \textcolor{comment}{    if(obter\_jogador\_atual(estado) == 1)\{}
141 \textcolor{comment}{        estado->jogadas[obter\_numero\_de\_jogadas(estado)].jogador1 = nula;}
142 \textcolor{comment}{    \}else\{}
143 \textcolor{comment}{        estado->jogadas[obter\_numero\_de\_jogadas(estado)].jogador2 = nula;}
144 \textcolor{comment}{    \}*/}
145 
146     \hyperlink{tabuleiro_8h_aa0b6c1689e60ac852a73d67e066c1df5}{mostrar\_tabuleiro}(estado);
147     \textcolor{comment}{//printf("\(\backslash\)n%d %d", estado->ultima\_jogada.coluna, estado->ultima\_jogada.linha);}
148 
149     fclose(file\_p);
150 \}
\end{DoxyCode}
